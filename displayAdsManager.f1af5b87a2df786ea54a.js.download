"use strict";(self.webpackChunk_msnews_msnews_experiences=self.webpackChunk_msnews_msnews_experiences||[]).push([["displayAdsManager"],{36202:function(e,t,a){a.d(t,{_:function(){return n}});var o=a(24709);class n{}n.updateMoatEnabledState=new o.C("UpdateMoatEnabledState"),n.updateForceEnableMoatState=new o.C("UpdateForceEnableMoat"),n.updateRefreshAdsState=new o.C("UpdateRefreshAds")},17073:function(e,t,a){a.d(t,{t:function(){return o}});const o={appNexusAdsSdkUrl:"acdn.adnxs.com/ast/ast.js",moatJsUrl:"z.moatads.com/adtechmsftstaging299008436443/moatad.js",enableMoat:!0,insertMoatBeforeAdCall:!0,insertMoatBeforeAdCallPrefix:"adstart",insertMoatAfterAdCall:!1,insertMoatAfterAdCallPrefix:"adavailable",insertMoatAtHeadEnd:!1,insertMoatAtHeadEndPrefix:"headend",moatSampleRate:7,sampleRatePassedToMoat:1,forceEnableMoat:!1,moatSamplingValuePrefix:"#zMoatSampling=",moatInsertMethodPrefix:"&zMoatMethod="}},23082:function(e,t,a){a.r(t),a.d(t,{DisplayAdsManagerActions:function(){return o._},DisplayAdsManagerConnector:function(){return u},DisplayAdsManagerConstants:function(){return i.t},DisplayAdsManagerReducer:function(){return c},ToolingInfo:function(){return f}});var o=a(36202),n=a(30666),r=a(42122),s=a(5302),d=a(21215),l=a(22680),i=a(17073),p=a(44132);class u extends n.e{constructor(e,t,a,o,n,r,s){super(e,t,a,o,n,r,s),this.isMoatJsLoaded=!1,this.httpsPrefix="https://",this.appNexusSdkLoaded=!1,this.loadingAppNexusSdkPromise=null,r.enableMoat&&this.updateMoatEnabledState(r.enableMoat),r.forceEnableMoat&&this.updateForceEnableMoatState(r.forceEnableMoat)}updateMoatEnabledState(e){o._.updateMoatEnabledState.getActionSender(this).send(e)}updateForceEnableMoatState(e){o._.updateForceEnableMoatState.getActionSender(this).send(e)}updateRefreshAdsState(e,t){o._.updateRefreshAdsState.getActionSender(this).send(e,t)}async loadAppNexusSdk(){if(!this.appNexusSdkLoaded)return this.loadingAppNexusSdkPromise||(this.loadingAppNexusSdkPromise=new Promise(((e,t)=>{if(!(0,d.N)())return;const a=this.httpsPrefix+i.t.appNexusAdsSdkUrl,o=(0,l.b0)(a,void 0,!0,null);o.onload=()=>{this.appNexusSdkLoaded=!0,e()},o.onerror=e=>{t(e),r.k.logError(`DisplayAd: Error on loading ${a}`),p.M0.sendAppErrorEvent({...s.xsK,message:e.toString()})},document.body.appendChild(o)}))),this.loadingAppNexusSdkPromise}async loadMoatUrl(){if(this.isMoatJsLoaded||!(0,d.N)())return;const e=this.getCurrentState();return e.enableMoat&&this.IsClientSelectedForMoat(i.t.moatSampleRate,e.forceEnableMoat)?new Promise(((e,t)=>{let a=null;a=i.t.insertMoatAfterAdCall?i.t.insertMoatAfterAdCallPrefix:i.t.insertMoatBeforeAdCall?i.t.insertMoatBeforeAdCallPrefix:i.t.insertMoatAtHeadEndPrefix;const o=this.httpsPrefix+i.t.moatJsUrl+i.t.moatSamplingValuePrefix+i.t.sampleRatePassedToMoat+i.t.moatInsertMethodPrefix+a,n=(0,l.b0)(o,void 0,!0,null);n.onload=()=>{this.isMoatJsLoaded=!0,e()},n.onerror=e=>{r.k.logError(`DisplayAd: Error on loading ${o}`),p.M0.sendAppErrorEvent({...s.wuF,message:e.toString()}),t(e)},document.body.appendChild(n)})):void 0}IsClientSelectedForMoat(e,t){return!!t||100*Math.random()<=e}}var M=a(38947);class c{reduce(e,t){if(!e)return{appNexusAdsSdkUrl:i.t.appNexusAdsSdkUrl,moatJsUrl:i.t.moatJsUrl,enableMoat:i.t.enableMoat,insertMoatBeforeAdCall:i.t.insertMoatBeforeAdCall,insertMoatAfterAdCall:i.t.insertMoatAfterAdCall,insertMoatAtHeadEnd:i.t.insertMoatAtHeadEnd,moatSampleRate:i.t.moatSampleRate,sampleRatePassedToMoat:i.t.sampleRatePassedToMoat,forceEnableMoat:i.t.forceEnableMoat,refreshAds:!1,galleryPerformanceHealthMeter:0};if(!t)return e;let a,n=!1;return n=n||M.G.handleAction(t,o._.updateMoatEnabledState,(t=>{a={...e,enableMoat:t}})),n=n||M.G.handleAction(t,o._.updateForceEnableMoatState,(t=>{a={...e,forceEnableMoat:t}})),n=n||M.G.handleAction(t,o._.updateRefreshAdsState,((t,o)=>{a={...e,galleryPerformanceHealthMeter:o,refreshAds:t}})),a||e}}const f={experienceConfigSchema:{}}}}]);